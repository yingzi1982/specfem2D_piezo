!========================================================================
!
!                   S P E C F E M 2 D ** PIEZO
!                   --------------------------------
!
!                     Author: Yingzi Ying
!                     yingzi.ying@me.com
!
!========================================================================

module piezo_par

use constants, only: CUSTOM_REAL

implicit none

logical, parameter :: is_piezo = .true.

double precision, dimension(:,:), allocatable :: charges

double precision, dimension(:), allocatable :: voltage_time_function

integer :: charge_number

double precision, parameter :: vacuum_permittivity = 8.55e-12

double precision, parameter, dimension(3,6) :: piezoelectric_constant_3d = reshape(&
[0.0d0, 0.0d0, 0.0d0, 0.0d0, 3.83d0, -2.37d0,&
-2.37d0, 2.37d0, 0.0d0, 3.83d0, 0.0d0, 0.0d0,&
0.23d0, 0.23d0, 1.3d0, 0.0d0, 0.0d0, 0.0d0  ], shape(piezoelectric_constant_3d), order=[2,1])

double precision, parameter, dimension(2,3) :: piezoelectric_constant_2d = piezoelectric_constant_3d([1,3],[1,3,5])

end module piezo_par


!
!========================================================================
!
